<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Source code generated by UnvUS.
 ! Copyright(c) 2017 unvus.com All rights reserved.
 ! Template skrull-pack-mybatis:src/main/resources/mybatis/sql/MybatisBase.e.vm.xml
 ! Template is part of project: https://git.unvus.com/unvus/opensource/pack-unvus-mybatis
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.neofect.gts.core.services.attach.repository.AttachRepository_">

    <!--region ====================================================================================== reference only -->
    <resultMap id="_metaInfo" type="java.util.Map">
        <!-- Generated Files -->
        <result property="model_" column="com.neofect.gts.core.services.attach.domain.Attach_"/>
        <result property="repository_" column="com.neofect.gts.core.services.attach.repository.AttachRepository_"/>
        <!-- Extended Files -->
        <result property="model" column="com.neofect.gts.core.services.attach.domain.Attach"/>
        <result property="repository" column="com.neofect.gts.core.services.attach.repository.AttachRepository"/>
    </resultMap>

    <!--
     ! All Columns
     !  attach_id, attach_ref_target, attach_ref_target_key, attach_ref_target_type, attach_display_name, attach_saved_name, attach_saved_dir, attach_file_type, attach_file_size, attach_deleted, attach_ext, attach_created_by, attach_created_dt
    -->

    <!--endregion =================================================================================== reference only -->

    <resultMap id="simpleAttachResult_" type="com.neofect.gts.core.services.attach.domain.Attach">
        <!-- 파일ID -->
        <id     property="id" column="attach_id"/>
        <!-- 참조구분 -->
        <result property="refTarget" column="attach_ref_target"/>
        <!-- 참조구분키 -->
        <result property="refTargetKey" column="attach_ref_target_key"/>
        <!-- 참조타입 -->
        <result property="refTargetType" column="attach_ref_target_type"/>
        <!-- 표시파일명 -->
        <result property="displayName" column="attach_display_name"/>
        <!-- 저장파일명 -->
        <result property="savedName" column="attach_saved_name"/>
        <!-- 저장경로 -->
        <result property="savedDir" column="attach_saved_dir"/>
        <!-- 파일타입 -->
        <result property="fileType" column="attach_file_type"/>
        <!-- 파일사이즈 -->
        <result property="fileSize" column="attach_file_size"/>
        <!-- 삭제여부 -->
        <result property="deleted" column="attach_deleted"/>
        <!-- 확장컬럼 -->
        <result property="ext" column="attach_ext"/>
        <!-- 등록자 -->
        <result property="createdBy" column="attach_created_by"/>
        <!-- 등록일시 -->
        <result property="createdDt" column="attach_created_dt"/>
    </resultMap>

    <sql id="simpleAttachCondition_">
        <where>
            <include refid="conditions_" />
        </where>
    </sql>

    <sql id="conditions_">
        <include refid="Common.bindAlias"/>
        <if test="ids != null and !ids.isEmpty()">
            AND ${_alias}attach_id IN <foreach collection="ids" item="idValue" open="(" close=")" separator=",">#{ idValue }</foreach>
        </if>
        <if test="id != null">
            AND ${_alias}attach_id = #{id}
        </if>
        <if test="refTarget != null and refTarget != ''">
            AND ${_alias}attach_ref_target = #{refTarget}
        </if>
        <if test="refTargetKey != null">
            AND ${_alias}attach_ref_target_key = #{refTargetKey}
        </if>
        <if test="refTargetType != null and refTargetType != ''">
            AND ${_alias}attach_ref_target_type = #{refTargetType}
        </if>
        <if test="displayName != null and displayName != ''">
            AND ${_alias}attach_display_name = #{displayName}
        </if>
        <if test="savedName != null and savedName != ''">
            AND ${_alias}attach_saved_name = #{savedName}
        </if>
        <if test="savedDir != null and savedDir != ''">
            AND ${_alias}attach_saved_dir = #{savedDir}
        </if>
        <if test="fileType != null and fileType != ''">
            AND ${_alias}attach_file_type = #{fileType}
        </if>
        <if test="fileSize != null">
            AND ${_alias}attach_file_size = #{fileSize}
        </if>
        <if test="deleted != null">
            AND ${_alias}attach_deleted = #{deleted}
        </if>
        <if test="ext != null and ext != ''">
            AND ${_alias}attach_ext = #{ext}
        </if>
        <if test="createdBy != null">
            AND ${_alias}attach_created_by = #{createdBy}
        </if>
        <if test="createdDt != null and createdDt.enabled == true">
            <if test="createdDt.from != null and createdDt.from != ''">
            AND ${_alias}attach_created_dt >= STR_TO_DATE(#{createdDt.from}, '%Y.%m.%d')
            </if>
            <if test="createdDt.to != null and createdDt.to != ''">
            AND ${_alias}attach_created_dt <![CDATA[ < ]]> DATE_ADD(STR_TO_DATE(#{createdDt.to}, '%Y.%m.%d'), INTERVAL 1 DAY)
            </if>
        </if>
    </sql>

    <sql id="columns_">
        <include refid="Common.bindAlias"/>
        <include refid="Common.bindAsPrefix"/>

        <choose>
        <when test="'${_asPrefix}' != '' and !'${_asPrefix}'.endsWith('}')">
            ${_alias}attach_id AS ${_asPrefix}attach_id, ${_alias}attach_ref_target AS ${_asPrefix}attach_ref_target, ${_alias}attach_ref_target_key AS ${_asPrefix}attach_ref_target_key, ${_alias}attach_ref_target_type AS ${_asPrefix}attach_ref_target_type, ${_alias}attach_display_name AS ${_asPrefix}attach_display_name, ${_alias}attach_saved_name AS ${_asPrefix}attach_saved_name, ${_alias}attach_saved_dir AS ${_asPrefix}attach_saved_dir, ${_alias}attach_file_type AS ${_asPrefix}attach_file_type, ${_alias}attach_file_size AS ${_asPrefix}attach_file_size, ${_alias}attach_deleted AS ${_asPrefix}attach_deleted, ${_alias}attach_ext AS ${_asPrefix}attach_ext, ${_alias}attach_created_by AS ${_asPrefix}attach_created_by, ${_alias}attach_created_dt AS ${_asPrefix}attach_created_dt        </when>
        <otherwise>
            ${_alias}attach_id, ${_alias}attach_ref_target, ${_alias}attach_ref_target_key, ${_alias}attach_ref_target_type, ${_alias}attach_display_name, ${_alias}attach_saved_name, ${_alias}attach_saved_dir, ${_alias}attach_file_type, ${_alias}attach_file_size, ${_alias}attach_deleted, ${_alias}attach_ext, ${_alias}attach_created_by, ${_alias}attach_created_dt        </otherwise>
        </choose>
    </sql>

    <sql id="columns_without_id_">
        <include refid="Common.bindAlias"/>
        <include refid="Common.bindAsPrefix"/>

        <choose>
        <when test="'${_asPrefix}' != '' and !'${_asPrefix}'.endsWith('}')">
            ${_alias}attach_ref_target AS ${_asPrefix}attach_ref_target, ${_alias}attach_ref_target_key AS ${_asPrefix}attach_ref_target_key, ${_alias}attach_ref_target_type AS ${_asPrefix}attach_ref_target_type, ${_alias}attach_display_name AS ${_asPrefix}attach_display_name, ${_alias}attach_saved_name AS ${_asPrefix}attach_saved_name, ${_alias}attach_saved_dir AS ${_asPrefix}attach_saved_dir, ${_alias}attach_file_type AS ${_asPrefix}attach_file_type, ${_alias}attach_file_size AS ${_asPrefix}attach_file_size, ${_alias}attach_deleted AS ${_asPrefix}attach_deleted, ${_alias}attach_ext AS ${_asPrefix}attach_ext, ${_alias}attach_created_by AS ${_asPrefix}attach_created_by, ${_alias}attach_created_dt AS ${_asPrefix}attach_created_dt        </when>
        <otherwise>
            ${_alias}attach_ref_target, ${_alias}attach_ref_target_key, ${_alias}attach_ref_target_type, ${_alias}attach_display_name, ${_alias}attach_saved_name, ${_alias}attach_saved_dir, ${_alias}attach_file_type, ${_alias}attach_file_size, ${_alias}attach_deleted, ${_alias}attach_ext, ${_alias}attach_created_by, ${_alias}attach_created_dt        </otherwise>
        </choose>
    </sql>


    <sql id="ins_columns_">
        <include refid="Common.bindAlias"/>
        ${_alias}attach_id, ${_alias}attach_ref_target, ${_alias}attach_ref_target_key, ${_alias}attach_ref_target_type, ${_alias}attach_display_name, ${_alias}attach_saved_name, ${_alias}attach_saved_dir, ${_alias}attach_file_type, ${_alias}attach_file_size, ${_alias}attach_deleted, ${_alias}attach_ext, ${_alias}attach_created_by, ${_alias}attach_created_dt    </sql>

    <sql id="ins_columns_without_id_">
        <include refid="Common.bindAlias"/>
        ${_alias}attach_ref_target, ${_alias}attach_ref_target_key, ${_alias}attach_ref_target_type, ${_alias}attach_display_name, ${_alias}attach_saved_name, ${_alias}attach_saved_dir, ${_alias}attach_file_type, ${_alias}attach_file_size, ${_alias}attach_deleted, ${_alias}attach_ext, ${_alias}attach_created_by, ${_alias}attach_created_dt    </sql>

    <select id="simpleGetAttach" parameterType="long" resultMap="simpleAttachResult_">
        /* AttachRepository_.simpleGetAttach */

        SELECT
            <include refid="columns_" />
        FROM
            nv_attach
        WHERE
        attach_id = #{id}
	</select>

    <select id="simpleListAttachCnt" resultType="int">
        /* AttachRepository_.simpleListAttachCnt */

        SELECT COUNT(*)
        FROM nv_attach
        <include refid="simpleAttachCondition_" />
    </select>

    <select id="simpleListAttach" resultMap="simpleAttachResult_">
        /* AttachRepository_.simpleListAttach */
        SELECT
            <include refid="columns_" />
        FROM nv_attach
        <include refid="simpleAttachCondition_" />
        <include refid="Common.sort"/>
        <include refid="Common.pagingFooter"/>
	</select>

    <sql id="update_dynamic_content_">
        <include refid="Common.bindAlias"/>
        <if test="refTarget != null and refTarget != ''">
            ${_alias}attach_ref_target = #{refTarget},
        </if>
        <if test="refTargetKey != null">
            ${_alias}attach_ref_target_key = #{refTargetKey},
        </if>
        <if test="refTargetType != null and refTargetType != ''">
            ${_alias}attach_ref_target_type = #{refTargetType},
        </if>
        <if test="displayName != null and displayName != ''">
            ${_alias}attach_display_name = #{displayName},
        </if>
        <if test="savedName != null and savedName != ''">
            ${_alias}attach_saved_name = #{savedName},
        </if>
        <if test="savedDir != null and savedDir != ''">
            ${_alias}attach_saved_dir = #{savedDir},
        </if>
        <if test="fileType != null and fileType != ''">
            ${_alias}attach_file_type = #{fileType},
        </if>
        <if test="fileSize != null">
            ${_alias}attach_file_size = #{fileSize},
        </if>
        <if test="deleted != null">
            ${_alias}attach_deleted = #{deleted},
        </if>
        <if test="ext != null and ext != ''">
            ${_alias}attach_ext = #{ext},
        </if>
    </sql>

    <update id="updateAttach" parameterType="com.neofect.gts.core.services.attach.domain.Attach">
        /* com.unvus.iflex.core.services.attach.repository.AttachRepository_.updateAttach */

        UPDATE nv_attach
        SET
             attach_ref_target = #{refTarget}
            , attach_ref_target_key = #{refTargetKey}
            , attach_ref_target_type = #{refTargetType}
            , attach_display_name = #{displayName}
            , attach_saved_name = #{savedName}
            , attach_saved_dir = #{savedDir}
            , attach_file_type = #{fileType}
            , attach_file_size = #{fileSize}
            , attach_deleted = #{deleted}
            , attach_ext = #{ext}
        WHERE
            attach_id = #{id}
    </update>

    <update id="updateAttachDynamic" parameterType="com.neofect.gts.core.services.attach.domain.Attach">
        /* AttachRepository_.updateAttachDynamic */

        UPDATE nv_attach
            <set>
            <include refid="update_dynamic_content_" />
            </set>
        WHERE
            attach_id = #{id}
    </update>

    <delete id="deleteAttach" parameterType="long">
        /* com.unvus.iflex.core.services.attach.repository.AttachRepository_.deleteAttach */

        DELETE FROM nv_attach
        WHERE
            attach_id = #{id}
    </delete>

    <sql id="insert_values_">

        #{refTarget},
        #{refTargetKey},
        #{refTargetType},
        #{displayName},
        #{savedName},
        #{savedDir},
        #{fileType},
        #{fileSize},
        #{deleted},
        #{ext},
        #{createdBy},
        #{createdDt}
    </sql>

    <insert id="insertAttach">
        /* AttachRepository_.insertAttach */


        INSERT INTO nv_attach
        (
        <include refid="ins_columns_without_id_" />
        )
        VALUES (
        <include refid="insert_values_" />
        )
        <selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>

	</insert>

</mapper>

