<?xml version="1.0" encoding="UTF-8"?>
<!--
 ! Source code generated by UnvUS.
 ! Copyright(c) 2017 unvus.com All rights reserved.
 ! Template skrull-pack-mybatis:src/main/resources/mybatis/sql/MybatisBase.e.vm.xml
 ! Template is part of project: https://git.unvus.com/unvus/opensource/pack-unvus-mybatis
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.neofect.gts.core.services.common.repository.CodePlRepository_">

    <resultMap id="simpleCodePlResult_" type="com.neofect.gts.core.services.common.domain.CodePl">
        
        <id     property="plType" column="PL_TYPE"/>
        
        <id     property="itemCode" column="ITEM_CODE"/>
        
        <result property="itemName" column="ITEM_NAME"/>
        
        <result property="acntDiv" column="ACNT_DIV"/>
        
        <result property="acntCode" column="ACNT_CODE"/>
        
        <result property="showYn" column="SHOW_YN"/>
        
        <result property="calcYn" column="CALC_YN"/>
        
        <result property="calcItemCode" column="CALC_ITEM_CODE"/>
        
        <result property="calcRate" column="CALC_RATE"/>
        <!-- 예정데이터 출처 G: GTS, S: 전월 slip, E: 기타 -->
        <result property="preSource" column="PRE_SOURCE"/>
    </resultMap>

    <sql id="simpleCodePlCondition_">
        <where>
            <include refid="conditions_" />
        </where>
    </sql>

    <sql id="conditions_">
        <include refid="Common.bindAlias"/>
        <if test="plTypes != null and !plTypes.isEmpty()">
            AND ${_alias}PL_TYPE IN <foreach collection="plTypes" item="plTypeValue" open="(" close=")" separator=",">#{ plTypeValue }</foreach>
        </if>
        <if test="itemCodes != null and !itemCodes.isEmpty()">
            AND ${_alias}ITEM_CODE IN <foreach collection="itemCodes" item="itemCodeValue" open="(" close=")" separator=",">#{ itemCodeValue }</foreach>
        </if>
        <if test="plType != null and plType != ''">
            AND ${_alias}PL_TYPE = #{plType}
        </if>
        <if test="itemCode != null and itemCode != ''">
            AND ${_alias}ITEM_CODE = #{itemCode}
        </if>
        <if test="itemName != null and itemName != ''">
            AND ${_alias}ITEM_NAME = #{itemName}
        </if>
        <if test="acntDiv != null and acntDiv != ''">
            AND ${_alias}ACNT_DIV = #{acntDiv}
        </if>
        <if test="acntCode != null and acntCode != ''">
            AND ${_alias}ACNT_CODE = #{acntCode}
        </if>
        <if test="showYn != null and showYn != ''">
            AND ${_alias}SHOW_YN = #{showYn}
        </if>
        <if test="calcYn != null and calcYn != ''">
            AND ${_alias}CALC_YN = #{calcYn}
        </if>
        <if test="calcItemCode != null and calcItemCode != ''">
            AND ${_alias}CALC_ITEM_CODE = #{calcItemCode}
        </if>
        <if test="calcRate != null">
            AND ${_alias}CALC_RATE = #{calcRate}
        </if>
        <if test="preSource != null and preSource != ''">
            AND ${_alias}PRE_SOURCE = #{preSource}
        </if>
    </sql>

    <sql id="columns_">
        <include refid="Common.bindAlias"/>
        <include refid="Common.bindAsPrefix"/>

        <choose>
        <when test="'${_asPrefix}' != '' and !'${_asPrefix}'.endsWith('}')">
            ${_alias}PL_TYPE AS ${_asPrefix}PL_TYPE, ${_alias}ITEM_CODE AS ${_asPrefix}ITEM_CODE, ${_alias}ITEM_NAME AS ${_asPrefix}ITEM_NAME, ${_alias}ACNT_DIV AS ${_asPrefix}ACNT_DIV, ${_alias}ACNT_CODE AS ${_asPrefix}ACNT_CODE, ${_alias}SHOW_YN AS ${_asPrefix}SHOW_YN, ${_alias}CALC_YN AS ${_asPrefix}CALC_YN, ${_alias}CALC_ITEM_CODE AS ${_asPrefix}CALC_ITEM_CODE, ${_alias}CALC_RATE AS ${_asPrefix}CALC_RATE, ${_alias}PRE_SOURCE AS ${_asPrefix}PRE_SOURCE        </when>
        <otherwise>
            ${_alias}PL_TYPE, ${_alias}ITEM_CODE, ${_alias}ITEM_NAME, ${_alias}ACNT_DIV, ${_alias}ACNT_CODE, ${_alias}SHOW_YN, ${_alias}CALC_YN, ${_alias}CALC_ITEM_CODE, ${_alias}CALC_RATE, ${_alias}PRE_SOURCE        </otherwise>
        </choose>
    </sql>

    <sql id="columns_without_id_">
        <include refid="Common.bindAlias"/>
        <include refid="Common.bindAsPrefix"/>

        <choose>
        <when test="'${_asPrefix}' != '' and !'${_asPrefix}'.endsWith('}')">
            ${_alias}ITEM_NAME AS ${_asPrefix}ITEM_NAME, ${_alias}ACNT_DIV AS ${_asPrefix}ACNT_DIV, ${_alias}ACNT_CODE AS ${_asPrefix}ACNT_CODE, ${_alias}SHOW_YN AS ${_asPrefix}SHOW_YN, ${_alias}CALC_YN AS ${_asPrefix}CALC_YN, ${_alias}CALC_ITEM_CODE AS ${_asPrefix}CALC_ITEM_CODE, ${_alias}CALC_RATE AS ${_asPrefix}CALC_RATE, ${_alias}PRE_SOURCE AS ${_asPrefix}PRE_SOURCE        </when>
        <otherwise>
            ${_alias}ITEM_NAME, ${_alias}ACNT_DIV, ${_alias}ACNT_CODE, ${_alias}SHOW_YN, ${_alias}CALC_YN, ${_alias}CALC_ITEM_CODE, ${_alias}CALC_RATE, ${_alias}PRE_SOURCE        </otherwise>
        </choose>
    </sql>


    <sql id="ins_columns_">
        <include refid="Common.bindAlias"/>
        ${_alias}PL_TYPE, ${_alias}ITEM_CODE, ${_alias}ITEM_NAME, ${_alias}ACNT_DIV, ${_alias}ACNT_CODE, ${_alias}SHOW_YN, ${_alias}CALC_YN, ${_alias}CALC_ITEM_CODE, ${_alias}CALC_RATE, ${_alias}PRE_SOURCE    </sql>

    <sql id="ins_columns_without_id_">
        <include refid="Common.bindAlias"/>
        ${_alias}ITEM_NAME, ${_alias}ACNT_DIV, ${_alias}ACNT_CODE, ${_alias}SHOW_YN, ${_alias}CALC_YN, ${_alias}CALC_ITEM_CODE, ${_alias}CALC_RATE, ${_alias}PRE_SOURCE    </sql>

    <select id="simpleGetCodePl" parameterType="long" resultMap="simpleCodePlResult_">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.simpleGetCodePl */

        SELECT
            <include refid="columns_" />
        FROM
            GTS2016.CODE_PL
        WHERE
        PL_TYPE = #{plType}
        AND ITEM_CODE = #{itemCode}
	</select>

    <select id="simpleListCodePlCnt" resultType="int">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.simpleListCodePlCnt */

        SELECT COUNT(*)
        FROM GTS2016.CODE_PL
        <include refid="simpleCodePlCondition_" />
    </select>

    <select id="simpleListCodePl" resultMap="simpleCodePlResult_">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.simpleListCodePl */
        <include refid="Common.pagingHeader-oracle"/>
        SELECT
            <include refid="columns_" />
        FROM GTS2016.CODE_PL
        <include refid="simpleCodePlCondition_" />
        <include refid="Common.sort"/>
        <include refid="Common.pagingFooter-oracle"/>
	</select>

    <sql id="update_dynamic_content_">
        <include refid="Common.bindAlias"/>
        <if test="itemName != null and itemName != ''">
            ${_alias}ITEM_NAME = #{itemName},
        </if>
        <if test="acntDiv != null and acntDiv != ''">
            ${_alias}ACNT_DIV = #{acntDiv},
        </if>
        <if test="acntCode != null and acntCode != ''">
            ${_alias}ACNT_CODE = #{acntCode},
        </if>
        <if test="showYn != null and showYn != ''">
            ${_alias}SHOW_YN = #{showYn},
        </if>
        <if test="calcYn != null and calcYn != ''">
            ${_alias}CALC_YN = #{calcYn},
        </if>
        <if test="calcItemCode != null and calcItemCode != ''">
            ${_alias}CALC_ITEM_CODE = #{calcItemCode},
        </if>
        <if test="calcRate != null">
            ${_alias}CALC_RATE = #{calcRate},
        </if>
        <if test="preSource != null and preSource != ''">
            ${_alias}PRE_SOURCE = #{preSource},
        </if>
    </sql>

    <update id="updateCodePl" parameterType="com.neofect.gts.core.services.common.domain.CodePl">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.updateCodePl */

        UPDATE GTS2016.CODE_PL
        SET
             ITEM_NAME = #{itemName}
            , ACNT_DIV = #{acntDiv}
            , ACNT_CODE = #{acntCode}
            , SHOW_YN = #{showYn}
            , CALC_YN = #{calcYn}
            , CALC_ITEM_CODE = #{calcItemCode}
            , CALC_RATE = #{calcRate}
            , PRE_SOURCE = #{preSource}
        WHERE
            PL_TYPE = #{plType}
            AND ITEM_CODE = #{itemCode}
    </update>

    <update id="updateCodePlDynamic" parameterType="com.neofect.gts.core.services.common.domain.CodePl">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.updateCodePlDynamic */

        UPDATE GTS2016.CODE_PL
            <set>
            <include refid="update_dynamic_content_" />
            </set>
        WHERE
            PL_TYPE = #{plType}
            AND ITEM_CODE = #{itemCode}
    </update>

    <delete id="deleteCodePl" parameterType="long">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.deleteCodePl */

        DELETE FROM GTS2016.CODE_PL
        WHERE
            PL_TYPE = #{plType}
            AND ITEM_CODE = #{itemCode}
    </delete>

    <sql id="insert_values_">

        #{itemName},
        #{acntDiv},
        #{acntCode},
        #{showYn},
        #{calcYn},
        #{calcItemCode},
        #{calcRate},
        #{preSource}
    </sql>

    <insert id="insertCodePl">
        /* com.neofect.gts.core.services.common.repository.CodePlRepository_.insertCodePl */


        INSERT INTO GTS2016.CODE_PL
        (
        <include refid="ins_columns_without_id_" />
        )
        VALUES (
        <include refid="insert_values_" />
        )
        <selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>

	</insert>

</mapper>

