/*
 * Source code generated by UnvUS.
 * Copyright(c) 2017 unvus.com All rights reserved.
 * Template pack-unvus-mybatis:src/main/java/rest/Rest.e.vm.java
 * Template is part of project: https://git.unvus.com/unvus/opensource/pack-unvus-mybatis
 */
package com.neofect.gts.web.cms.rest.common;

import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.web.bind.annotation.*;

import com.neofect.gts.core.services.common.domain.ActionLog;
import com.neofect.gts.core.services.common.domain.enums.ActionType;
import com.neofect.gts.core.services.common.domain.enums.RefTarget;
import com.neofect.gts.core.services.common.service.ActionLogService;

import lombok.extern.slf4j.Slf4j;

/**
 * Rest for {@link ActionLog}<br/>
 */
@Slf4j
@RestController
@RequestMapping("/api")
public class ActionLogResource {

    private final ActionLogService actionLogService;

    public ActionLogResource(ActionLogService actionLogService) {
        this.actionLogService = actionLogService;
    }

    //region ------------------------------------------------------------------------------------------------ actionLog API

    /**
     * add
     */
    @PostMapping(value = "/actionLog", produces = MediaType.APPLICATION_JSON_VALUE)
    public ResponseEntity<Map<String, Object>> addActionLog(HttpServletRequest request) {
    	RefTarget target = RefTarget.getByCode(request.getParameter("refTarget"));
    	ActionType actionType = ActionType.getByCode(request.getParameter("action"));

        try {
			actionLogService.addActionLog(target, request.getParameter("refTargetType"), actionType, request.getParameter("message"));
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

        return ResponseEntity.ok().build();
    }
    //endregion

}
